# ğŸ”´ PentestLab Enterprise v2.0

## Industry-Grade API Security Testing & Penetration Testing Platform

> **The most comprehensive intentionally vulnerable application for security professionals, students, and enterprise training.**

[![Python](https://img.shields.io/badge/Python-3.8%2B-blue)]()
[![Flask](https://img.shields.io/badge/Flask-3.0-green)]()
[![License](https://img.shields.io/badge/License-Educational%20Use-red)]()
[![Vulnerabilities](https://img.shields.io/badge/Vulnerabilities-52%2B-critical)]()

---

## ğŸ“‹ Table of Contents

1. [Quick Start](#-quick-start)
2. [Features](#-features)
3. [Vulnerability Coverage](#-vulnerability-coverage)
4. [Installation](#-installation)
5. [Usage](#-usage)
6. [Testing Tools Integration](#-testing-tools-integration)
7. [Learning Path](#-learning-path)
8. [Project Structure](#-project-structure)
9. [Security Standards](#-security-standards)
10. [Disclaimer](#âš ï¸-disclaimer)

---

## ğŸš€ Quick Start

### For Windows Users:
```batch
START_PENTESTLAB.bat
```

### For Linux/macOS Users:
```bash
chmod +x start_pentestlab.sh
./start_pentestlab.sh
```

### Manual Start:
```bash
# Create virtual environment
python3 -m venv venv
source venv/bin/activate  # or: venv\Scripts\activate on Windows

# Install dependencies
pip install -r requirements.txt

# Run API
python3 pentestlab_api.py

# API available at http://localhost:5000
```

---

## âœ¨ Features

### ğŸ¯ **Comprehensive Vulnerability Coverage**
- **52+ Real-world vulnerabilities** across OWASP standards
- **OWASP Top 10 Web 2021** (A01-A10)
- **OWASP Top 10 Web 2025** (Latest standards)
- **OWASP Top 10 API 2021** (API-01 to API-10)
- **OWASP Top 10 API 2023** (Evolved vulnerabilities)
- **Extra Security Issues** (XXE, SSRF, Race Conditions, etc.)

### ğŸ› ï¸ **Multi-Tool Integration**
- **Postman**: 40+ pre-configured test cases with scripts
- **Burp Suite**: Scanner integration with custom payloads
- **OWASP ZAP**: Active & passive scanning automation
- **SQLMap**: SQL injection exploitation automation
- **FFUF**: Fuzzing templates and wordlist integration

### ğŸ“š **Enterprise-Grade Documentation**
- **Beginner Level**: What, why, and how each vulnerability works
- **Intermediate Level**: Real-world exploitation techniques
- **Advanced Level**: Detection evasion and chaining vulnerabilities
- **Defensive Level**: How to fix, test, and monitor
- **Real Breach Examples**: LinkedIn, Equifax, TalkTalk, and more

### ğŸ”’ **Security-First Design**
- Intentionally vulnerable for **authorized testing only**
- Detailed attack logging and monitoring
- Secure code examples for every vulnerability
- Compliance mapping (PCI-DSS, HIPAA, GDPR, SOX)

### ğŸ“Š **Professional Dashboards & Reporting**
- Interactive vulnerability dashboard
- Real-time attack monitoring
- Assessment report generation
- Compliance impact analysis

---

## ğŸ¯ Vulnerability Coverage Matrix

```
VULNERABILITY CATEGORY        COUNT   SEVERITY   STANDARDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SQL Injection                  1      CRITICAL   2021, 2025
XSS (All Types)               3      CRITICAL   2021, 2025
IDOR / Access Control         4      CRITICAL   2021, 2025, API
Authentication Flaws          5      HIGH       2021, 2025, API
Information Disclosure        3      HIGH       2021, 2025
SSRF                          1      HIGH       2021, 2025
Business Logic Flaws          3      MEDIUM     2021, 2025
XXE / XML Injection           2      CRITICAL   2021, 2025
Weak Cryptography             3      CRITICAL   2021, 2025
Insecure Deserialization      2      CRITICAL   2021, 2025
API Specific Vulnerabilities  10     CRITICAL   API2021, API2023
Extra Security Issues         12     VARIES     Custom
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TOTAL VULNERABILITIES         52     MIXED      ALL STANDARDS
```

---

## ğŸ’¿ Installation

### Prerequisites
- **Python 3.8+** ([Download](https://www.python.org/downloads/))
- **Git** ([Download](https://git-scm.com/downloads))
- **Postman** (Optional, for testing)

### Step 1: Clone Repository
```bash
git clone https://github.com/pentestlab/pentestlab-enterprise.git
cd pentestlab-enterprise
```

### Step 2: Setup Virtual Environment
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/macOS
python3 -m venv venv
source venv/bin/activate
```

### Step 3: Install Dependencies
```bash
pip install -r requirements.txt
```

### Step 4: Run Application
```bash
python pentestlab_api.py
```

### Step 5: Access Dashboard
Open browser: `http://localhost:5000`

---

## ğŸ® Usage

### Accessing Vulnerable Endpoints

**SQL Injection:**
```bash
curl "http://localhost:5000/api/injection/sqli/boolean?username=' OR '1'='1"
```

**XSS (Reflected):**
```bash
curl "http://localhost:5000/api/xss/reflected?message=<img src=x onerror=alert(1)>"
```

**IDOR (Unauthorized Access):**
```bash
curl "http://localhost:5000/api/access/idor/2"
```

**Exposed Configuration:**
```bash
curl "http://localhost:5000/api/config/exposed"
```

### Using Postman Collection

1. **Open Postman** â†’ Click **Import**
2. **Select File**: `PENTESTLAB_POSTMAN_COLLECTION.json`
3. **Set Variables**:
   - `base_url`: `http://localhost:5000`
   - `jwt_token`: (populated after login)
4. **Click Request** to test vulnerability

### Using SQLMap

```bash
# Enumerate databases
sqlmap -u "http://localhost:5000/api/injection/sqli/boolean?username=1" --dbs

# Dump specific table
sqlmap -u "http://localhost:5000/api/injection/sqli/boolean?username=1" \
  -D pentestlab -T user --dump

# Exploit with UNION
sqlmap -u "http://localhost:5000/api/injection/sqli/union?search=1" \
  --technique=U -D pentestlab -T user --columns
```

---

## ğŸ› ï¸ Testing Tools Integration

### Postman (REST API Testing)

**Built-in Features:**
- Pre-request scripts for auth setup
- Test assertions (pass/fail verification)
- Visual request/response inspection
- Collection variables and environment management

**Examples in Collection:**
- SQL Injection boolean-based testing
- XSS payload variations
- IDOR enumeration
- Default credential testing
- SSRF URL variations

### Burp Suite (Web Vulnerability Scanner)

**Setup:**
1. Add target: `http://localhost:5000`
2. Configure scanner: SQLi, XSS, Auth, Access Control
3. Run preliminary scan
4. Use intruder for custom payloads

**CLI Usage:**
```bash
java -jar burpsuite_pro.jar --scan-config-file=sqli.xml \
  http://localhost:5000
```

### OWASP ZAP (Automated Scanning)

**Setup:**
```bash
# Start ZAP in daemon mode
zaproxy -daemon -port 8090 -config api.disablekey=true

# Scan application
curl "http://localhost:8090/JSON/spider/action/scan?url=http://localhost:5000"

# Export report
curl "http://localhost:8090/JSON/reports/action/generate?title=PentestLab"
```

### SQLMap (SQL Injection Automation)

```bash
# Detect DBMS
sqlmap -u "http://localhost:5000/api/injection/sqli/boolean?username=1" --dbs --batch

# Extract all data
sqlmap -u "http://localhost:5000/api/injection/sqli/boolean?username=1" \
  --dump-all --batch -v 3

# Custom techniques (Blind)
sqlmap -u "http://localhost:5000/api/injection/sqli/time-based?id=1" \
  --technique=T --time-sec=5
```

### FFUF (Web Fuzzing)

```bash
# Enumerate API endpoints
ffuf -u "http://localhost:5000/api/FUZZ" \
  -w endpoints.txt \
  -fc 404

# Parameter fuzzing
ffuf -u "http://localhost:5000/api/injection/sqli/boolean?username=FUZZ" \
  -w sqli_payloads.txt \
  -mr "count.*[2-9]"
```

---

## ğŸ“š Learning Path

### ğŸŸ¢ Beginner Level
Start here if you're new to security testing:

1. **[SQL Injection Basics](PENTESTLAB_VULNERABILITIES.json)**
   - What is SQL injection?
   - Why is it dangerous?
   - How to test for it in Postman
   - Real-world examples

2. **[Reflected XSS](PENTESTLAB_TESTING_GUIDE.md#2ï¸âƒ£-cross-site-scripting-xss)**
   - Understanding XSS payloads
   - Testing in browsers
   - Simple defense fixes

3. **[IDOR - Access Control](PENTESTLAB_TESTING_GUIDE.md#3ï¸âƒ£-insecure-direct-object-reference-idor)**
   - User ID enumeration
   - Lateral privilege escalation
   - Authorization checking

### ğŸŸ¡ Intermediate Level
Build upon fundamentals:

4. **[Time-Based SQL Injection](PENTESTLAB_TESTING_GUIDE.md#time-based-blind-sql-injection)**
   - Blind injection techniques
   - Response timing analysis
   - SQLMap automation

5. **[Stored XSS](PENTESTLAB_TESTING_GUIDE.md#stored-xss)**
   - Database storage requirements
   - Impact scope (all users)
   - Content Security Policy (CSP)

6. **[Information Disclosure](PENTESTLAB_TESTING_GUIDE.md#4ï¸âƒ£-information-disclosure---exposed-configuration)**
   - Error message analysis
   - Configuration exposure
   - Environment variable leakage

### ğŸ”´ Advanced Level
Master complex scenarios:

7. **[SSRF & Metadata Exploitation](PENTESTLAB_TESTING_GUIDE.md#6ï¸âƒ£-ssrf---server-side-request-forgery)**
   - AWS metadata access
   - Internal service enumeration
   - Blind SSRF detection

8. **[Race Conditions](PENTESTLAB_TESTING_GUIDE.md#5ï¸âƒ£-business-logic---negative-amount)**
   - Timing attacks
   - Atomicity violations
   - Concurrency exploitation

9. **[Business Logic Flaws](PENTESTLAB_TESTING_GUIDE.md#ğŸŸ¡-medium-severity)**
   - Bypass constraints
   - Negative amounts
   - Transaction manipulation

### ğŸŸ£ Expert Level (Capstone)

Research and document additional vulnerabilities:
- XXE (XML External Entities)
- CORS misconfigurations
- Path traversal
- Command injection

---

## ğŸ“‚ Project Structure

```
pentestlab-enterprise/
â”œâ”€â”€ pentestlab_api.py                    # Main Flask application
â”œâ”€â”€ PENTESTLAB_VULNERABILITIES.json      # Master vulnerability database
â”œâ”€â”€ PENTESTLAB_POSTMAN_COLLECTION.json   # Postman testing collection
â”œâ”€â”€ PENTESTLAB_TESTING_GUIDE.md          # Comprehensive testing guide
â”œâ”€â”€ requirements.txt                      # Python dependencies
â”œâ”€â”€ START_PENTESTLAB.bat                 # Windows startup script
â”œâ”€â”€ start_pentestlab.sh                  # Linux/macOS startup script
â”‚
â”œâ”€â”€ instance/
â”‚   â””â”€â”€ pentestlab.db                   # SQLite development database
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ DEPLOYMENT_GUIDE.md              # Cloud deployment instructions
â”‚   â”œâ”€â”€ TOOL_INTEGRATION_GUIDE.md         # Burp, ZAP, SQLMap setup
â”‚   â”œâ”€â”€ LEARNING_RESOURCES.md            # Additional learning materials
â”‚   â””â”€â”€ SECURITY_POLICY.md               # Responsible disclosure
â”‚
â””â”€â”€ tests/
    â”œâ”€â”€ test_sqli.py                    # SQL injection test cases
    â”œâ”€â”€ test_xss.py                     # XSS vulnerability tests
    â””â”€â”€ test_idor.py                    # IDOR access control tests
```

---

## ğŸ” Security Standards

**Compliant with / Coverage of:**

| Standard | Coverage | Details |
|----------|----------|---------|
| OWASP Top 10 2021 | 10/10 (100%) | All web vulnerabilities |
| OWASP Top 10 2025 | 10/10 (100%) | Latest web standards |
| OWASP API Top 10 2021 | 10/10 (100%) | All API vulnerabilities |
| OWASP API Top 10 2023 | 10/10 (100%) | Latest API threats |
| CWE Top 25 | 20/25 (80%) | Most critical weaknesses |
| CVSS v3.1 | âœ“ Scored | Risk assessment |
| PCI-DSS | âœ“ Mapped | Payment security |
| HIPAA | âœ“ Mapped | Healthcare security |
| GDPR | âœ“ Mapped | Data privacy |
| SOX | âœ“ Mapped | Financial security |

---

## ğŸ“Š Vulnerability Summary

**By Severity:**
- ğŸ”´ **CRITICAL**: 18 vulnerabilities
- ğŸŸ  **HIGH**: 18 vulnerabilities
- ğŸŸ¡ **MEDIUM**: 12 vulnerabilities
- ğŸŸ¢ **LOW**: 4 vulnerabilities

**By Category:**
- Injection Attacks: 8
- XSS Variants: 4
- Access Control: 6
- Authentication: 5
- Encryption/Data: 3
- API Specific: 10
- Business Logic: 3
- Information Disclosure: 3
- Extra Issues: 2

---

## ğŸ“ Certification Preparation

PentestLab Enterprise helps prepare for:
- âœ… CEH (Certified Ethical Hacker)
- âœ… OSCP (Offensive Security PWK)
- âœ… Security+
- âœ… GCIH (GIAC Certified Incident Handler)
- âœ… eWPT (eLearnSecurity Web Penetration Tester)

---

## ğŸ”§ Advanced Configuration

### Custom Database (PostgreSQL for Production)

Update `pentestlab_api.py`:
```python
app.config['SQLALCHEMY_DATABASE_URI'] = 'postgresql://user:password@localhost/pentestlab'
```

### Enable HTTPS

```python
from OpenSSL import SSL
context = SSL.Context(SSL.TLSv1_2_METHOD)
context.use_privatekey_file('key.pem')
context.use_certificate_file('cert.pem')

app.run(ssl_context=context)
```

### Increase Rate Limiting

Add Redis integration for brute force protection:
```bash
pip install redis
pip install flask-limiter
```

---

## ğŸ“ Logging & Monitoring

All attacks are logged to `APILog` table:
- Endpoint accessed
- HTTP method
- Payload used
- Timestamp
- Attack classification

**View logs:**
```bash
sqlite3 instance/pentestlab.db
SELECT * FROM api_log WHERE is_attack = true ORDER BY timestamp DESC;
```

---

## ğŸ› Troubleshooting

### Port Already in Use
```bash
# Find process using port 5000
lsof -i :5000  # macOS/Linux
netstat -ano | findstr :5000  # Windows

# Kill process
kill -9 <PID>  # macOS/Linux
taskkill /PID <PID> /F  # Windows
```

### Database Locked
```bash
# Delete old database and reinitialize
rm instance/pentestlab.db
python pentestlab_api.py
```

### Module Not Found
```bash
# Verify virtual environment activation
which python  # Should show venv path

# Reinstall dependencies
pip install --force-reinstall -r requirements.txt
```

---

## ğŸ“ Support & Community

- **Documentation**: [PENTESTLAB_TESTING_GUIDE.md](PENTESTLAB_TESTING_GUIDE.md)
- **Issues & Bugs**: Report in GitHub Issues
- **Learning**: See [learning resources](docs/LEARNING_RESOURCES.md)

---

## âš ï¸ Disclaimer

**IMPORTANT LEGAL NOTICE**

This is an **intentionally vulnerable application** created for:
- âœ… Authorized penetration testing
- âœ… Security research and education
- âœ… Training and skill development
- âœ… Compliance assessment

This application is **NOT** for:
- âŒ Unauthorized system access
- âŒ Illegal hacking activities
- âŒ Production deployment
- âŒ Testing systems you don't own

**Unauthorized Access Warning:**
```
Unauthorized access to computer systems is a federal crime
punishable by imprisonment and fines under the Computer Fraud
and Abuse Act (18 U.S.C. Â§ 1030).
```

By using this application, you agree to:
1. Only test on systems you own or have written permission to test
2. Follow all applicable laws and regulations
3. Use findings responsibly and ethically
4. Report vulnerabilities through proper channels
5. Not cause harm to any systems or data

---

## ğŸ“„ License

Educational Use Only - See [LICENSE](LICENSE)

---

## ğŸ™ Acknowledgments

Created for security professionals, students, and enterprises.

**Built with:**
- Flask (Python Web Framework)
- SQLAlchemy (Database ORM)
- SQLite (Development Database)
- Postman (API Testing)

**Inspired by:**
- OWASP Top 10
- HackTheBox
- TryHackMe
- PortSwigger Labs

---

## ğŸš€ What's Next?

1. **Start the API**: Run `START_PENTESTLAB.bat` or `./start_pentestlab.sh`
2. **Import Postman Collection**: Upload `PENTESTLAB_POSTMAN_COLLECTION.json`
3. **Read the Testing Guide**: Open `PENTESTLAB_TESTING_GUIDE.md`
4. **Follow Learning Path**: Start with Beginner level
5. **Document Findings**: Use provided templates

---

**PentestLab Enterprise v2.0**  
*Professional Security Training Platform*  
Built for pentesterers, students, and enterprises worldwide.

---

### Quick Links
- ğŸ“˜ [Testing Guide](PENTESTLAB_TESTING_GUIDE.md)
- ğŸ“Š [Vulnerabilities Database](PENTESTLAB_VULNERABILITIES.json)
- ğŸ”— [Postman Collection](PENTESTLAB_POSTMAN_COLLECTION.json)
- ğŸ› ï¸ [Tool Integration Guide](docs/TOOL_INTEGRATION_GUIDE.md)
- ğŸ“š [Learning Resources](docs/LEARNING_RESOURCES.md)
