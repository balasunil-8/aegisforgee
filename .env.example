# PentestLab Enterprise v2.0 - Environment Configuration
# Copy this to .env and customize for your environment

# ============================================================
# FLASK CONFIGURATION
# ============================================================
FLASK_ENV=development
FLASK_DEBUG=True
FLASK_APP=pentestlab_api.py
SECRET_KEY=dev-pentestlab-secret-key-2026
JWT_SECRET_KEY=jwt-pentestlab-2026-secret

# ============================================================
# DATABASE CONFIGURATION
# ============================================================
# Development (SQLite)
SQLALCHEMY_DATABASE_URI=sqlite:///pentestlab.db
SQLALCHEMY_TRACK_MODIFICATIONS=False

# Production (PostgreSQL) - Uncomment to use
# SQLALCHEMY_DATABASE_URI=postgresql://user:password@localhost:5432/pentestlab

# ============================================================
# API CONFIGURATION
# ============================================================
API_HOST=0.0.0.0
API_PORT=5000
API_WORKERS=4

# ============================================================
# JWT CONFIGURATION
# ============================================================
JWT_ACCESS_TOKEN_EXPIRES=3600  # 1 hour in seconds
JWT_REFRESH_TOKEN_EXPIRES=2592000  # 30 days

# ============================================================
# CORS CONFIGURATION
# ============================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:5000
CORS_ALLOW_HEADERS=Content-Type,Authorization
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS

# ============================================================
# SECURITY HEADERS
# ============================================================
# Content-Security-Policy (CSP)
CSP_ENABLED=True
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self'
CSP_STYLE_SRC='self'

# CORS Headers
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5000

# ============================================================
# LOGGING CONFIGURATION
# ============================================================
LOG_LEVEL=INFO
LOG_FILE=logs/pentestlab.log
LOG_MAX_SIZE=10485760  # 10MB
LOG_BACKUP_COUNT=10

# ============================================================
# RATE LIMITING
# ============================================================
RATE_LIMIT_ENABLED=False  # Set to True in production
RATE_LIMIT_STORAGE_URL=redis://localhost:6379
RATE_LIMIT_DEFAULT=100/hour  # 100 requests per hour
RATE_LIMIT_AUTH_LOGIN=5/minute  # 5 login attempts per minute

# ============================================================
# EMAIL CONFIGURATION (Optional)
# ============================================================
MAIL_SERVER=smtp.gmail.com
MAIL_PORT=587
MAIL_USE_TLS=True
MAIL_USERNAME=noreply@pentestlab.local
MAIL_PASSWORD=your-app-password-here
MAIL_DEFAULT_SENDER=PentestLab <noreply@pentestlab.local>

# ============================================================
# AWS CONFIGURATION (Optional - for SSRF testing)
# ============================================================
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=AKIA1234567890ABCDEF
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
AWS_S3_BUCKET=pentestlab-training

# ============================================================
# STRIPE CONFIGURATION (Optional - for payment testing)
# ============================================================
STRIPE_PUBLIC_KEY=pk_test_abcd1234
STRIPE_SECRET_KEY=sk_test_abcd1234

# ============================================================
# MONITORING & OBSERVABILITY
# ============================================================
SENTRY_DSN=https://your-sentry-dsn@sentry.io/12345
DATADOG_API_KEY=your-datadog-api-key
MONITORING_ENABLED=False

# ============================================================
# DEVELOPMENT/TESTING FLAGS
# ============================================================
# WARNING: These should ALWAYS be False in production!
DEBUG_MODE=True
EXPOSE_SQL_QUERIES=True
EXPOSE_CONFIG=True
ALLOW_DEFAULT_CREDENTIALS=True
DISABLE_AUTH_CHECKS=False

# ============================================================
# VULNERABILITY SIMULATION FLAGS
# ============================================================
# Enable/disable specific vulnerability categories
ENABLE_SQLi=True
ENABLE_XSS=True
ENABLE_IDOR=True
ENABLE_SSRF=True
ENABLE_XXE=True
ENABLE_BROKEN_AUTH=True

# ============================================================
# DEPLOYMENT CONFIGURATION
# ============================================================
ENVIRONMENT=development  # development, staging, production
ALLOWED_HOSTS=localhost,127.0.0.1,0.0.0.0
MAX_CONTENT_LENGTH=16777216  # 16MB max request size

# ============================================================
# CACHE CONFIGURATION (Optional)
# ============================================================
CACHE_TYPE=simple  # simple, redis, memcached
CACHE_REDIS_URL=redis://localhost:6379/0
CACHE_DEFAULT_TIMEOUT=300

# ============================================================
# SESSION CONFIGURATION
# ============================================================
SESSION_TYPE=filesystem
PERMANENT_SESSION_LIFETIME=3600  # 1 hour
SESSION_COOKIE_SECURE=False  # Set to True in production with HTTPS
SESSION_COOKIE_HTTPONLY=True
SESSION_COOKIE_SAMESITE=Lax

# ============================================================
# FEATURES & EXPERIMENTAL
# ============================================================
ENABLE_METRICS=True
ENABLE_HEALTH_CHECK=True
ENABLE_API_DOCS=True
EXPERIMENTAL_FEATURES=False
